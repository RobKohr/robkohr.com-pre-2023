<html><head><meta charset="utf-8"><title>&lt;b&gt;A new way to round - rand_round&lt;/b&gt;&lt;br&gt;So in grade school you are taught t...</title><style>body {font: 11pt Roboto, Arial, sans-serif; max-width: 640px; margin: 24px;}.author-photo {border-radius: 50%; margin-right: 10px; width: 40px;}.author {font-weight: 500;}.main-content {margin: 15px 0 15px;}.post-title {font-weight: bold;}.location {display: block; margin-top: 15px;}.location img {float: left; margin-right: 5px; width: 20px;}.media-link {display: inline-block; max-width: 100%; vertical-align: top;}.media-link p {margin-top: 5px; max-height: 4em; overflow: scroll;}.media {max-height: 100vh; max-width: 100%;}.video-placeholder {background: black; display: flex; height: 300px; max-width: 100%; width: 640px;}.play-icon {border-bottom: 30px solid transparent; border-left: 50px solid white; border-top: 30px solid transparent; color: white; margin: auto;}.album {max-height: 800px; overflow: scroll; width: calc(100vw - 48px);}.album .media-link {margin-right: 5px; max-width: 250px;}.album .media {max-height: 250px;}.link-embed {border-top: 1px solid lightgrey; display: block; margin-top: 20px;}.link-embed img {max-width: 100%;}.inline-link-embed {display: block;}.inline-link-embed img {vertical-align: middle;}.link-title {display: inline-block; font-size: medium; font-weight: 300; padding-left: 1em;}.reshare-attribution {display: block; font-weight: bold; margin-bottom: 10px;}.poll-image {margin-bottom: 5px; max-height: 300px; max-width: 500px;}.poll-choice {align-items: center; display: flex; margin-bottom: 5px; max-width: 500px;}.poll-choice-percentage {background-color: lightblue; height: 100%; left: 0; position: absolute; z-index: -1;}.poll-choice-selected {margin-right: 5px;}.poll-choice-results {border: 1px solid lightgray; border-radius: 5px; display: flex; line-height: 40px; overflow: hidden; padding: 0 8px; position: relative;}.poll-choice-results, .poll-choice-description {flex-grow: 1; margin-right: 10px;}.poll-choice-image {width: 100%;}.poll-choice-image, .poll-choice-image img {max-height: 40px; max-width: 100px;}.poll-choice-votes {max-height: 100px; overflow: auto;}.plus-entity-embed {color: black; display: block; text-decoration: none;}.plus-entity-embed-cover-photo {max-height: 300px; max-width: 100%;}.plus-entity-embed-info {padding: 0 1em 1em;}.plus-entity-embed-info h2 {font-weight: 500; margin: 10px 0;}.plus-entity-embed-info p {font-size: small; margin: 0;}.collection-owner-avatar {border-radius: 50%; border: 2px solid white; height: 40px; margin-top: -22px;}.visibility {padding: 1em 0; border-top: 1px solid grey;}.post-activity {padding: 1em 0; border-top: 1px solid grey;}.post-kind-desc {margin-bottom: 15pt;}.comments {border-top: 1px solid gray; padding-top: 1em;}.comment + .comment {margin-top: 1em;}.comment .media-link, .comment .inline-link-embed {margin-top: 5px;}</style></head><body itemid="https://plus.google.com/+RobKohr/posts/6jnicsApoj4" itemscope itemtype="http://schema.org/SocialMediaPosting"><div style="margin-bottom:1em;"><div style="display:flex; align-items:center"><span itemprop="author" itemscope itemtype="http://schema.org/Person"><img class="author-photo" src="https://lh3.googleusercontent.com/a-/AAuE7mDf8D_Ocqr5I5mLUS_xxY4AmUlTsK7W-ZWmqEFC5g=s64-c" alt="Rob Kohr" itemprop="image"><a href="https://plus.google.com/+RobKohr" target="_blank" class="author" itemprop="url"><span itemprop="name">Rob Kohr</span></a></span> - <a target="_blank" href="https://plus.google.com/+RobKohr/posts/6jnicsApoj4"><span itemprop="dateCreated">2012-09-08T10:50:06-0400</span></a><span> - Updated: <span itemprop="dateModified">2012-09-08T10:50:06-0400</span></span></div><div class="main-content"><span itemprop="text"><b>A new way to round - rand_round</b><br>So in grade school you are taught the basics of rounding. If the decimal portion of the number is &lt; .5 round down to the integer so 5.3 becomes 5. If it is &gt;= .5 round up, so 5.8 becomes 6.<br> <br>This is well and good if you are doing something that has an even distribution after the decimal point. But lets say that you are doing continuous small adjustments on a value and it is unlikely to be an evenly distributed set since the calculation for the adjustment will typically be the same.<br> <br>An example senerio that got me thinking about this is related to a game I am working on at <a rel="nofollow" target="_blank" href="http://constantsail.com" class="ot-anchor bidi_isolate" jslog="10929; track:click" dir="ltr">constantsail.com</a>. Every minute 1 food is consumed for each crew member on a ship, but I want to do a smaller time slice of every 6 seconds which is 1/10 of a food per crew for that interval. Food is an integer in the db, so it must be rounded off in one way or another. If we just used the round function in mysql, and we had two crew members, I would be subtracting round(.2) ever time which comes out to zero. What I really want is it to return zero 80% of the time, and one 20% of the time, so in the long run, it still ends up being 2 food consumed for the two crew for every minute.<br> <br>To do this I take the result of rand() which returns a value from 0 to 1 and if it is less than D (which is the decmial portion of the value we are rounding) we add 1 to the floored value of our original number, else we just floor the value.<br> <br>The equation is:<br> <br>function rand_round(x){<br> D = x - floor(x);<br> if(rand()&lt;D){<br>   return floor(x)+1;<br> }else{<br>   return floor(x);<br> }<br>}</span></div></div><span itemprop="audience"><div class="visibility">Shared with: Public</div></span><meta itemprop="commentCount" content="1"><div class="comments"><div class="comment" itemprop="comment" itemscope itemtype="http://schema.org/Comment"><span itemprop="author" itemscope itemtype="http://schema.org/Person"><a target="_blank" href="https://plus.google.com/100987927745139115788" class="author" itemprop="url"><span itemprop="name">Aaron</span></a></span><span class="time"> - <span itemprop="dateCreated">2017-08-27T03:11:53-0400</span></span><div class="comment-content" itemprop="text">I always do it based on if the number is even or odd. That way it&#39;s not random, but it gives an even distribution.</div></div></div></body></html>